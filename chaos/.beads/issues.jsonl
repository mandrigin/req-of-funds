{"id":"ch-0y4","title":"Implement Core Data Model (Swift types for .inputforge.json)","description":"Implement all Swift model types matching the InputForge data schema. All types must be Codable, Identifiable, and Observable (@Observable macro).\n\n## Types to implement (in Models/ directory):\n\n### ProjectDocument.swift\n- InputForgeProject: top-level container\n  - version: String (\"1.0\")\n  - projectId: UUID\n  - context: ProjectContext enum (work/personal)\n  - persona: Persona\n  - inputs: [InputItem]\n  - interrogation: InterrogationSession\n  - versions: [ProjectVersion]\n  - settings: ProjectSettings\n\n### InputItem.swift\n- InputItem: individual input\n  - id: UUID\n  - type: InputType enum (image, document, audio, video, text, mindmap, wardleymap)\n  - sourceFilename: String\n  - importedAt: Date\n  - dataRef: String (relative path or inline text)\n  - annotations: [Annotation]\n\n### Annotation.swift\n- Annotation: sticky note on an input\n  - id: UUID, text: String, createdAt: Date, updatedAt: Date\n\n### Persona.swift\n- Persona: name + systemPrompt\n- Built-in personas as static constants: CPO, Engineer, Parent, Homeowner\n- BuiltInPersona enum\n\n### InterrogationSession.swift\n- InterrogationMessage: role (assistant/user), content, attachments, timestamp\n- InterrogationSession: messages array + summaries\n\n### ProjectVersion.swift\n- ProjectVersion: versionNumber, timestamp, persona, clarityScore, output, inputSnapshot\n- OutputPlan: description + milestones array\n- Milestone: title, description, deliverables\n- Deliverable: title, description, tasks\n- PlanTask: title, nextAction, tags (TaskTags), uncertaintyFlag\n- TaskTags: context, estimate, due, defer, flagged\n\n### ProjectSettings.swift\n- AIBackend enum: cloud, local, preferLocal\n- ProjectSettings: aiBackend, apiKeyRef (never stores actual key)\n\n## Verification\n- All types conform to Codable — round-trip encode/decode test\n- Sample .inputforge.json from spec can be decoded\n- All types conform to Identifiable\n- @Observable macro on mutable model types","status":"open","priority":0,"issue_type":"task","created_at":"2026-02-02T12:46:30.088556+01:00","created_by":"mayor","updated_at":"2026-02-02T12:46:30.088556+01:00","dependencies":[{"issue_id":"ch-0y4","depends_on_id":"ch-5dm","type":"blocks","created_at":"2026-02-02T12:46:56.282658+01:00","created_by":"mayor"}]}
{"id":"ch-1r2","title":"Implement Annotation System (sticky notes per input)","description":"Implement the sticky-note annotation system for input items.\n\n## Annotation UI\n- Each input card has an annotation indicator (count badge)\n- Click input → expandable annotation panel appears\n- Add annotation button (+ keyboard shortcut)\n- Each annotation: editable plain text field, timestamp\n- Delete annotation (swipe or X button)\n- Drag to reorder annotations within an input\n\n## Data Integration  \n- Annotations stored in InputItem.annotations array\n- Persisted in document save\n- Passed to AI alongside input content during analysis\n\n## Verification\n- Add/edit/delete annotations on any input\n- Annotations persist across save/reopen\n- Multiple annotations per input work correctly\n- Keyboard shortcut adds annotation to selected input\n\nDepends on: Input handling (ch-w7i)","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:47:57.897577+01:00","created_by":"mayor","updated_at":"2026-02-02T12:47:57.897577+01:00","dependencies":[{"issue_id":"ch-1r2","depends_on_id":"ch-w7i","type":"blocks","created_at":"2026-02-02T12:48:24.989176+01:00","created_by":"mayor"}]}
{"id":"ch-27t","title":"Digest: mol-witness-patrol","description":"Patrol cycle 3: All quiet. Obsidian build SUCCEEDED, now writing SPEC.md - nearing task completion. Refinery running. No mail, no cleanup wisps, no gates, no swarms. Deacon still stopped (escalated in cycle 1).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T12:50:09.145714+01:00","updated_at":"2026-02-02T12:50:09.145714+01:00","closed_at":"2026-02-02T12:50:09.145648+01:00","close_reason":"Squashed from 10 wisps","dependencies":[{"issue_id":"ch-27t","depends_on_id":"ch-wisp-9j8","type":"parent-child","created_at":"2026-02-02T12:50:09.14644+01:00","created_by":"chaos/witness"}]}
{"id":"ch-48w","title":"[EPIC] InputForge: AI Backend Abstraction","description":"Pluggable AI backend protocol. Google Gemini API client (two keys: work/personal). Apple Foundation Models wrapper (macOS 26). Backend selection logic (cloud/local/prefer-local-fallback-cloud). Context-aware key routing.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:43:57.693256+01:00","created_by":"mayor","updated_at":"2026-02-02T12:43:57.693256+01:00","dependencies":[{"issue_id":"ch-48w","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:50.631942+01:00","created_by":"mayor"}]}
{"id":"ch-5dm","title":"Scaffold Xcode project: InputForge macOS app","description":"attached_molecule: ch-wisp-0c0\nattached_at: 2026-02-02T11:46:02Z\ndispatched_by: mayor\n\nCreate the InputForge Xcode project from scratch in the chaos-taming-monorepo. Requirements:\n\n## Xcode Project Setup\n- macOS 26+ deployment target\n- Swift + SwiftUI app lifecycle\n- NSDocument-based multi-document architecture (InputForgeDocument subclass)\n- App sandbox enabled\n\n## NSDocument Architecture  \n- InputForgeDocument: NSDocument subclass bridged to SwiftUI\n- Document type registration for .inputforge (custom UTI)\n- File package format: NSFileWrapper containing project.json + assets/ directory\n- Standard multi-window behavior: Cmd-N new, Cmd-O open, Cmd-S save\n\n## Project Structure\n```\nInputForge/\n├── App/\n│   ├── InputForgeApp.swift          (SwiftUI App with DocumentGroup)\n│   └── InputForgeDocument.swift     (NSDocument subclass)\n├── Models/                          (empty, for Phase 2)\n├── Views/                           (empty, for Phase 2)\n├── Services/                        (empty, for Phase 2)\n├── Resources/\n│   └── Info.plist\n└── InputForge.entitlements\n```\n\n## Verification\n- App launches, shows empty document window\n- Cmd-N creates new document\n- Cmd-S saves .inputforge package\n- Cmd-O reopens saved document\n- Multiple documents open simultaneously\n\nIMPORTANT: Store the full InputForge spec in a SPEC.md file at repo root for reference by future workers.\n\nSpec reference: The full InputForge product specification should be committed alongside the project.","status":"closed","priority":0,"issue_type":"task","assignee":"chaos/polecats/obsidian","created_at":"2026-02-02T12:45:06.496537+01:00","created_by":"mayor","updated_at":"2026-02-02T12:50:10.517984+01:00","closed_at":"2026-02-02T12:50:10.517984+01:00","close_reason":"Closed","dependencies":[{"issue_id":"ch-5dm","depends_on_id":"ch-wisp-0c0","type":"blocks","created_at":"2026-02-02T12:46:02.315104+01:00","created_by":"mayor"}]}
{"id":"ch-5l8","title":"[EPIC] InputForge: Input Handling","description":"Drag-and-drop from Finder (pdf, docx, txt, md, rtf, pages, images, audio, video, mindmap, wardley map screenshots). Clipboard paste. Inline audio recording. Input card grid/tray UI with thumbnails, type badges, timestamps. Input reordering.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:44:03.065803+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:03.065803+01:00","dependencies":[{"issue_id":"ch-5l8","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:50.78829+01:00","created_by":"mayor"},{"issue_id":"ch-5l8","depends_on_id":"ch-tfk","type":"blocks","created_at":"2026-02-02T12:44:50.864596+01:00","created_by":"mayor"}]}
{"id":"ch-5pi","title":"[EPIC] InputForge: Design System (Cyberdeck Aesthetic)","description":"Teenage Engineering / Cyberdeck / DIY Glitch aesthetic. Exposed-grid layouts, monospaced type accents, high-contrast UI elements, subtle glitch/scan-line effects. Work vs Personal color schemes. Functional beauty over polish. Define color palette, typography, spacing, component styles.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:44:21.642934+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:21.642934+01:00","dependencies":[{"issue_id":"ch-5pi","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:51.610279+01:00","created_by":"mayor"}]}
{"id":"ch-7iz","title":"Implement Persona system: built-in personas + custom CRUD","description":"Implement the Persona system for InputForge.\n\n## Persona Model (already in data model)\n- Persona: name (String) + systemPrompt (String)\n- Needs: management layer on top\n\n## Built-in Persona System Prompts\nAuthor the actual system prompts for 4 built-in personas:\n\n### CPO (Chief Product Officer)\n- Output as product roadmap\n- OKRs, success metrics, stakeholder map, competitive considerations\n- Questions probe: user needs, market context, resource constraints, prioritization\n\n### Engineer  \n- Technical project plan framing\n- Architecture decisions, spike/research tasks, technical debt, definition of done\n- Questions probe: tech stack, dependencies, performance requirements, edge cases\n\n### Parent\n- Household/family project framing\n- Scheduling constraints, family member assignments, budget, age-appropriate delegation\n- Questions probe: timeline, who is involved, budget, seasonal constraints\n\n### Homeowner\n- Home improvement/maintenance framing\n- Contractor coordination, permits, material lists, budget tracking\n- Questions probe: DIY vs contractor, budget, timeline, code requirements\n\n## Custom Persona CRUD\n- Create new persona (name + system prompt)\n- Edit existing custom persona\n- Delete custom persona (cannot delete built-in)\n- Stored in app-level UserDefaults or dedicated JSON file\n\n## Settings Integration\n- Per-context default persona (Work default, Personal default)\n- Persona switcher in Input Stage and throughout project\n\n## Persona Switching\n- When persona switches mid-project, flag that re-analysis is needed\n- If versions exist, prompt: \"Switching persona will re-process all inputs. Continue?\"\n\nDepends on: data model (ch-0y4)","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:47:31.3145+01:00","created_by":"mayor","updated_at":"2026-02-02T12:47:31.3145+01:00","dependencies":[{"issue_id":"ch-7iz","depends_on_id":"ch-0y4","type":"blocks","created_at":"2026-02-02T12:47:36.17169+01:00","created_by":"mayor"}]}
{"id":"ch-9de","title":"[EPIC] InputForge: TaskPaper Export","description":"Built-in TaskPaper hierarchy preview. Copy to clipboard as valid TaskPaper. Save as .taskpaper file. OmniFocus tag mapping: @due, @defer, @context, @estimate, @flagged, @type, @persona. Notes on indented lines. Verified OmniFocus import compatibility.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T12:44:12.784411+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:12.784411+01:00","dependencies":[{"issue_id":"ch-9de","depends_on_id":"ch-t95","type":"blocks","created_at":"2026-02-02T12:44:51.359049+01:00","created_by":"mayor"}]}
{"id":"ch-9v9","title":"Digest: mol-witness-patrol","description":"Patrol cycle 2: Inbox empty. No cleanup wisps. Refinery running. Obsidian actively working - building InputForge Xcode project, diagnosing build errors. No timer gates, no swarms. Deacon still stopped (already escalated cycle 1).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T12:49:35.202524+01:00","updated_at":"2026-02-02T12:49:35.202524+01:00","closed_at":"2026-02-02T12:49:35.202456+01:00","close_reason":"Squashed from 10 wisps","dependencies":[{"issue_id":"ch-9v9","depends_on_id":"ch-wisp-fma","type":"parent-child","created_at":"2026-02-02T12:49:35.20324+01:00","created_by":"chaos/witness"}]}
{"id":"ch-9yk","title":"Implement AI Backend abstraction + Gemini client","description":"Create the pluggable AI backend layer and Google Gemini API client.\n\n## AI Backend Protocol (Services/AI/)\n\n### AIBackend.swift\n- AIBackend protocol:\n  - func analyze(inputs: [ProcessedInput], persona: Persona, context: ProjectContext) async throws -\u003e OutputPlan\n  - func interrogate(messages: [InterrogationMessage], inputs: [ProcessedInput], persona: Persona) async throws -\u003e InterrogationMessage  \n  - func transcribe(audio: Data) async throws -\u003e String\n  - func describeImage(_ image: Data) async throws -\u003e String\n  - var isAvailable: Bool { get async }\n\n### ProcessedInput.swift\n- ProcessedInput: normalized representation of any input type\n  - Extracted text, image data, transcription, structured content\n  - Source InputItem reference\n  - Annotations text\n\n### GeminiBackend.swift\n- Google Gemini API client\n- Handles: text generation, vision (image analysis), audio transcription\n- Context-aware API key selection (work key vs personal key)\n- API key retrieved from Keychain at call time\n- Error handling: invalid key, rate limit, timeout (per spec error table)\n- Exponential backoff on rate limits\n\n### LocalAIBackend.swift (stub)\n- Stub implementation for Apple Foundation Models (macOS 26)\n- Protocol-conforming placeholder that returns .unavailable\n- Ready for real implementation when Foundation Models ships\n\n### AIBackendManager.swift\n- Resolves which backend to use based on ProjectSettings\n- Handles prefer-local-fallback-cloud logic\n- Enforces context isolation (work key never used for personal, vice versa)\n\n## Keychain Integration\n- KeychainService.swift: read/write API keys to macOS Keychain\n- Separate keychain items: \"InputForge-Work-APIKey\", \"InputForge-Personal-APIKey\"\n\n## Verification\n- Gemini client can make a basic text generation call\n- Context isolation: work project uses work key only\n- Rate limit handling with backoff works\n- LocalAI stub returns unavailable gracefully\n- Keychain read/write round-trip works","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:46:51.568715+01:00","created_by":"mayor","updated_at":"2026-02-02T12:46:51.568715+01:00","dependencies":[{"issue_id":"ch-9yk","depends_on_id":"ch-5dm","type":"blocks","created_at":"2026-02-02T12:46:56.435149+01:00","created_by":"mayor"}]}
{"id":"ch-auc","title":"[EPIC] InputForge: Settings \u0026 Preferences","description":"API keys stored in macOS Keychain (work key, personal key). Per-context AI backend selection (cloud/local/prefer-local). Per-context default persona. Configurable global hotkey. All keyboard shortcuts (Cmd-Shift-A analyze, Cmd-Shift-Q interrogation, Cmd-Shift-E export, Cmd-Shift-R record, Cmd-Shift-P persona, Cmd-Shift-V versions).","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T12:44:17.871248+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:17.871248+01:00","dependencies":[{"issue_id":"ch-auc","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:51.515095+01:00","created_by":"mayor"}]}
{"id":"ch-b11","title":"Implement TaskPaper Export: preview + copy + save","description":"Implement TaskPaper export with OmniFocus compatibility.\n\n## TaskPaper Generator (Services/Export/)\n- Convert OutputPlan hierarchy to TaskPaper format\n- Tag mapping: @due, @defer, @context, @estimate, @flagged, @type, @persona\n- Notes on indented lines below items (standard TaskPaper format)\n- Dates formatted YYYY-MM-DD\n\n## Preview UI\n- Full hierarchy tree view of TaskPaper output\n- Syntax-highlighted TaskPaper text view\n- Cmd-Shift-E opens preview\n\n## Export Actions\n- [COPY TO CLIPBOARD]: copies valid TaskPaper text\n- [SAVE AS FILE]: saves as .taskpaper file via NSSavePanel\n\n## Verification\n- Generated TaskPaper is valid and parseable\n- Paste into OmniFocus creates correct structure\n- All tags map to correct OmniFocus fields\n- Notes appear in OmniFocus notes field\n\nDepends on: Analysis engine (ch-doh)","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:48:57.507851+01:00","created_by":"mayor","updated_at":"2026-02-02T12:48:57.507851+01:00","dependencies":[{"issue_id":"ch-b11","depends_on_id":"ch-doh","type":"blocks","created_at":"2026-02-02T12:49:18.639256+01:00","created_by":"mayor"}]}
{"id":"ch-bqq","title":"Implement Design System: Cyberdeck theme tokens \u0026 components","description":"Create the InputForge design system following the Teenage Engineering / Cyberdeck / DIY Glitch aesthetic.\n\n## Design Tokens (Theme/)\n\n### Colors\n- Work context palette (scheme A): industrial, high-contrast\n- Personal context palette (scheme B): distinct from work, same aesthetic family\n- Semantic colors: background, surface, primary, secondary, accent, error, warning\n- Use SwiftUI Color extensions + asset catalog\n\n### Typography  \n- Primary: SF Mono or system monospaced for cyberdeck feel\n- Secondary: system font for readability in long text\n- Type scale: caption, body, headline, title, largeTitle\n- Font weight pairings\n\n### Spacing \u0026 Layout\n- Grid-based spacing system (4pt or 8pt base)\n- Exposed-grid layout helpers\n- Card/tile component styles\n\n### Effects\n- Subtle scan-line overlay effect (optional, toggleable)\n- High-contrast borders and dividers\n- Industrial/utilitarian button styles\n\n## Components (Views/Components/)\n- ForgeButton: styled button matching aesthetic\n- ForgeCard: input card tile component\n- ForgeBadge: type badge for inputs\n- ThemeEnvironment: environment key for Work/Personal switching\n\n## Verification\n- Work and Personal themes are visually distinct\n- Theme switches instantly when context changes\n- Monospaced accents visible in headings/labels\n- Components render correctly in light and dark mode","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:46:40.10785+01:00","created_by":"mayor","updated_at":"2026-02-02T12:46:40.10785+01:00","dependencies":[{"issue_id":"ch-bqq","depends_on_id":"ch-5dm","type":"blocks","created_at":"2026-02-02T12:46:56.361381+01:00","created_by":"mayor"}]}
{"id":"ch-chaos-crew-mandrigin","title":"Crew worker mandrigin in chaos - human-managed persistent workspace.","description":"Crew worker mandrigin in chaos - human-managed persistent workspace.\n\nrole_type: crew\nrig: chaos\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","created_at":"2026-02-02T12:41:28.550708+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:28.550708+01:00","labels":["gt:agent"]}
{"id":"ch-chaos-polecat-obsidian","title":"ch-chaos-polecat-obsidian","description":"ch-chaos-polecat-obsidian\n\nrole_type: polecat\nrig: chaos\nagent_state: spawning\nhook_bead: ch-5dm\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","created_at":"2026-02-02T12:45:33.791317+01:00","created_by":"mayor","updated_at":"2026-02-02T12:45:33.875514+01:00","labels":["gt:agent"],"hook_bead":"ch-5dm"}
{"id":"ch-chaos-refinery","title":"Refinery for chaos - processes merge queue.","description":"Refinery for chaos - processes merge queue.\n\nrole_type: refinery\nrig: chaos\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","created_at":"2026-02-02T12:41:15.403496+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:15.403496+01:00","labels":["gt:agent"]}
{"id":"ch-chaos-witness","title":"Witness for chaos - monitors polecat health and progress.","description":"Witness for chaos - monitors polecat health and progress.\n\nrole_type: witness\nrig: chaos\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","created_at":"2026-02-02T12:41:15.148204+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:15.148204+01:00","labels":["gt:agent"]}
{"id":"ch-cww","title":"Implement Context Fork wizard (Work/Personal)","description":"Implement the first step of the InputForge wizard: Work/Personal context selection.\n\n## New Project Flow\n- When user creates new document (Cmd-N), show full-screen wizard overlay\n- Two large buttons: [WORK] and [PERSONAL] — cyberdeck styled\n- Choice is permanent and stored in ProjectDocument.context\n- No UI to change after creation\n\n## On Selection\n- Set document context (work/personal)\n- Apply correct color scheme (ThemeEnvironment)\n- Select correct API key context\n- Load default persona for that context\n- Transition to Input Stage (empty input tray)\n\n## UI Requirements\n- Cyberdeck aesthetic: bold, high-contrast, industrial\n- \"Is this a work thing or a personal thing?\" header text\n- Each button shows context description\n- Smooth transition to input stage after selection\n\n## Verification\n- New document always shows context fork first\n- Cannot proceed without choosing\n- Work projects show Work color scheme throughout\n- Personal projects show Personal color scheme throughout  \n- Context is persisted in saved document\n- Reopened document does NOT show fork again (already chosen)\n\nDepends on: scaffolding (ch-5dm), data model (ch-0y4), design system (ch-bqq)","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:47:08.806444+01:00","created_by":"mayor","updated_at":"2026-02-02T12:47:08.806444+01:00","dependencies":[{"issue_id":"ch-cww","depends_on_id":"ch-0y4","type":"blocks","created_at":"2026-02-02T12:47:35.866816+01:00","created_by":"mayor"},{"issue_id":"ch-cww","depends_on_id":"ch-bqq","type":"blocks","created_at":"2026-02-02T12:47:35.943426+01:00","created_by":"mayor"}]}
{"id":"ch-doh","title":"Implement Analysis Engine: inputs → structured project plan","description":"Implement the core analysis pipeline that processes all inputs through the AI backend.\n\n## Analysis Pipeline (Services/Analysis/)\n\n### InputProcessor.swift\n- Process each InputItem based on type:\n  - Documents: extract text content\n  - Images/Screenshots: send to AI vision for description + OCR\n  - Audio: transcribe via AI backend\n  - Video: extract audio for transcription + key frames for vision analysis\n  - Mindmap files: parse structure (.mindnode, .mm, .opml) into node hierarchy\n  - Mindmap screenshots: AI vision → structured interpretation\n  - Wardley map screenshots: AI vision → components, evolution stages, dependencies, value chain\n  - Text: pass through directly\n- Combine extracted content with annotations\n- Return [ProcessedInput] array\n\n### AnalysisEngine.swift\n- Takes: [ProcessedInput] + active Persona + ProjectContext\n- Constructs AI prompt: persona system prompt + all processed inputs + annotations\n- Calls AIBackend.analyze()\n- Parses response into OutputPlan (milestones/deliverables/tasks/next-actions)\n- Generates uncertainty flags for low-confidence areas\n- Computes clarity/completeness score\n- Creates new ProjectVersion with snapshot\n\n### AnalysisPromptBuilder.swift\n- Builds the analysis prompt template\n- Includes persona system prompt\n- Structures inputs with metadata\n- Instructs AI on output format (JSON schema for OutputPlan)\n- Requests uncertainty flags and confidence levels\n- Requests clarity score\n\n## UI Integration\n- [ANALYZE] button (Cmd-Shift-A) triggers pipeline\n- Progress indicator during processing\n- Results displayed in structured tree view\n- Uncertainty flags shown as interactive badges\n- Clarity score as progress ring or percentage\n\n## Verification\n- Text-only inputs produce valid project plan\n- Image inputs trigger vision analysis\n- Audio inputs trigger transcription\n- Persona affects output structure and tone\n- Uncertainty flags appear on ambiguous items\n- Clarity score displays and is reasonable\n- New version created on each Analyze run\n- Cancel button works during processing\n\nDepends on: AI backend (ch-9yk), Input handling (ch-w7i), Persona system (ch-7iz)","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:47:54.696478+01:00","created_by":"mayor","updated_at":"2026-02-02T12:47:54.696478+01:00","dependencies":[{"issue_id":"ch-doh","depends_on_id":"ch-9yk","type":"blocks","created_at":"2026-02-02T12:48:24.768942+01:00","created_by":"mayor"},{"issue_id":"ch-doh","depends_on_id":"ch-w7i","type":"blocks","created_at":"2026-02-02T12:48:24.844966+01:00","created_by":"mayor"},{"issue_id":"ch-doh","depends_on_id":"ch-7iz","type":"blocks","created_at":"2026-02-02T12:48:24.916415+01:00","created_by":"mayor"}]}
{"id":"ch-ejz","title":"Implement Version History: auto-versioning + diff view","description":"Implement version history for project plans.\n\n## Auto-Versioning\n- New ProjectVersion created on every Analyze run\n- Version stores: full OutputPlan, timestamp, persona, clarity score, input snapshot (list of input IDs)\n- Version number auto-increments\n\n## Version List UI\n- Sidebar or dropdown accessible via Cmd-Shift-V\n- Each entry: version number, timestamp, persona name, clarity score\n- Click to view that version output\n\n## Diff View\n- Select any two versions for side-by-side comparison\n- Additions: green highlight\n- Removals: red highlight\n- Changes: amber highlight\n- Structural diff on the plan hierarchy (milestone/deliverable/task level)\n\n## Restore\n- Select a previous version → [RESTORE] button\n- Creates a NEW version (non-destructive) with the old output\n- \"Restored from version N\" metadata\n\n## Verification\n- Multiple Analyze runs create multiple versions\n- Version list shows all versions chronologically\n- Diff correctly highlights additions/removals/changes\n- Restore creates new version, does not destroy history\n\nDepends on: Analysis engine (ch-doh)","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:49:05.490599+01:00","created_by":"mayor","updated_at":"2026-02-02T12:49:05.490599+01:00","dependencies":[{"issue_id":"ch-ejz","depends_on_id":"ch-doh","type":"blocks","created_at":"2026-02-02T12:49:18.767644+01:00","created_by":"mayor"}]}
{"id":"ch-gfn","title":"[EPIC] InputForge: Annotation System (Sticky Notes)","description":"0..N editable plain-text annotations per input item. Visual sticky-note overlays or expandable panel. Add/edit/delete/reorder annotations. Keyboard shortcut to add annotation. Annotations passed to AI alongside input.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T12:44:05.102746+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:05.102746+01:00","dependencies":[{"issue_id":"ch-gfn","depends_on_id":"ch-5l8","type":"blocks","created_at":"2026-02-02T12:44:50.958006+01:00","created_by":"mayor"}]}
{"id":"ch-le4","title":"[EPIC] InputForge: Version History","description":"Auto-version on every Analyze run. Version stores: full output, timestamp, persona, clarity score, input snapshot. Version list (sidebar/dropdown). Diff view between any two versions (additions green, removals red, changes amber). Non-destructive restore to previous version.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T12:44:15.344368+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:15.344368+01:00","dependencies":[{"issue_id":"ch-le4","depends_on_id":"ch-t95","type":"blocks","created_at":"2026-02-02T12:44:51.435182+01:00","created_by":"mayor"}]}
{"id":"ch-mo8","title":"Implement Settings: Keychain API keys, preferences, global hotkey","description":"Implement the Settings/Preferences window.\n\n## Settings UI (SwiftUI Settings scene)\n- Two sections: Work Context / Personal Context\n- Per-context:\n  - API key field (stored in Keychain, masked display)\n  - AI backend selector: Cloud / Local / Prefer Local\n  - Default persona dropdown\n\n## Keychain Integration\n- Store API keys securely in macOS Keychain\n- Items: \"InputForge-Work-APIKey\", \"InputForge-Personal-APIKey\"\n- Read on demand (never cached in memory longer than needed)\n- Settings UI shows masked key with reveal toggle\n\n## Global Hotkey\n- User-configurable global keyboard shortcut\n- Brings app to front / creates new project\n- Use Carbon or modern macOS hotkey API\n- Default: configurable in Settings, no default set\n\n## Keyboard Shortcuts\n- Register all app-level shortcuts per spec:\n  Cmd-N, Cmd-O, Cmd-V, Cmd-Shift-A, Cmd-Shift-Q, Cmd-Shift-E, Cmd-Shift-R, Tab/Shift-Tab, Cmd-Shift-P, Cmd-Shift-V\n\n## Verification\n- API keys save to and load from Keychain\n- Work key and personal key are separate Keychain items\n- Backend selection persists across app restart\n- Default persona persists\n- Global hotkey works from any app\n\nDepends on: Scaffolding (ch-5dm)","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:49:14.184851+01:00","created_by":"mayor","updated_at":"2026-02-02T12:49:14.184851+01:00","dependencies":[{"issue_id":"ch-mo8","depends_on_id":"ch-5dm","type":"blocks","created_at":"2026-02-02T12:49:18.906001+01:00","created_by":"mayor"}]}
{"id":"ch-ov2","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"open","priority":2,"issue_type":"molecule","created_at":"2026-02-02T12:41:15.979868+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:15.979868+01:00"}
{"id":"ch-pi4","title":"[EPIC] InputForge: Context Fork (Work/Personal)","description":"New project wizard with Work/Personal selection. Permanent choice. UI color scheme switching. API key routing based on context. Privacy guarantee enforcement at API call layer.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:43:55.253003+01:00","created_by":"mayor","updated_at":"2026-02-02T12:43:55.253003+01:00","dependencies":[{"issue_id":"ch-pi4","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:50.481112+01:00","created_by":"mayor"},{"issue_id":"ch-pi4","depends_on_id":"ch-tfk","type":"blocks","created_at":"2026-02-02T12:44:50.554973+01:00","created_by":"mayor"}]}
{"id":"ch-qqc","title":"Implement Interrogation Mode: AI-driven chat clarification","description":"Implement the Interrogation Mode chat interface.\n\n## Triggering\n- [ASK ME QUESTIONS] button after analysis results\n- Tap uncertainty flag → opens targeted interrogation about that specific area\n- Cmd-Shift-Q toggles interrogation mode\n\n## Chat UI (Views/Interrogation/)\n- Chat-style message bubbles (scrollable history)\n- AI messages: left-aligned, themed\n- User messages: right-aligned, themed\n- Input area at bottom: text field + attachment options\n\n## Multi-Modal Replies\n- User can type text responses\n- User can drop files (any supported input type) as reply\n- User can record audio inline as reply\n- User can paste images/text from clipboard\n- Attachments shown inline in message bubbles\n\n## AI Behavior\n- Generate questions based on:\n  - Gaps in inputs\n  - Persona-specific domain knowledge\n  - Proactive completeness checks\n  - Contradictions between inputs\n- Extraction techniques from spec Appendix B\n- Running summary updated after each exchange\n- Clarity score updates live (displayed in header)\n- AI indicates when plan is sufficiently clear\n\n## Session Management\n- Messages stored in InterrogationSession\n- [DONE REFINING] button exits interrogation\n- Exiting triggers re-analysis with all interrogation context\n- New version created after re-analysis\n\n## Verification\n- Chat messages display correctly\n- AI asks relevant, persona-aware questions\n- Multi-modal replies work (text, image, audio, file)\n- Running summary updates after each exchange\n- Clarity score changes during interrogation\n- Done Refining triggers re-analysis and new version\n\nDepends on: Analysis engine","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:48:09.625257+01:00","created_by":"mayor","updated_at":"2026-02-02T12:48:09.625257+01:00","dependencies":[{"issue_id":"ch-qqc","depends_on_id":"ch-doh","type":"blocks","created_at":"2026-02-02T12:48:25.062463+01:00","created_by":"mayor"}]}
{"id":"ch-r8x","title":"Digest: mol-witness-patrol","description":"Patrol cycle 1: Inbox empty. No cleanup wisps. Refinery running, no pending MRs. 1 polecat (obsidian) actively working on InputForge scaffolding despite stale 'done' state in agent bead. No timer gates. No active swarms. Deacon stopped - escalated to Mayor. Inbox clean post-cycle.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T12:48:53.719043+01:00","updated_at":"2026-02-02T12:48:53.719043+01:00","closed_at":"2026-02-02T12:48:53.718975+01:00","close_reason":"Squashed from 10 wisps","dependencies":[{"issue_id":"ch-r8x","depends_on_id":"ch-wisp-nez","type":"parent-child","created_at":"2026-02-02T12:48:53.719767+01:00","created_by":"chaos/witness"}]}
{"id":"ch-rig-chaos","title":"chaos","description":"Rig identity bead for chaos.\n\nrepo: git@github.com:mandrigin/chaos-taming-monorepo.git\nprefix: ch\nstate: active","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T12:41:16.123569+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:16.123569+01:00","labels":["gt:rig"]}
{"id":"ch-t95","title":"[EPIC] InputForge: Analysis Engine","description":"Core analysis pipeline: collect all inputs + annotations, process through active persona's system prompt via AI backend, produce structured output (Project→Milestone→Deliverable→Task→NextAction). Uncertainty flags with confidence levels. Global clarity/completeness score. Auto-version creation on each run.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:44:07.409343+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:07.409343+01:00","dependencies":[{"issue_id":"ch-t95","depends_on_id":"ch-48w","type":"blocks","created_at":"2026-02-02T12:44:51.038143+01:00","created_by":"mayor"},{"issue_id":"ch-t95","depends_on_id":"ch-xl3","type":"blocks","created_at":"2026-02-02T12:44:51.116151+01:00","created_by":"mayor"},{"issue_id":"ch-t95","depends_on_id":"ch-5l8","type":"blocks","created_at":"2026-02-02T12:44:51.199869+01:00","created_by":"mayor"}]}
{"id":"ch-tfk","title":"[EPIC] InputForge: Core Data Model","description":"Swift types matching the .inputforge.json schema: ProjectDocument, InputItem, Annotation, Persona, InterrogationMessage, ProjectVersion, OutputPlan (milestones/deliverables/tasks/next-actions). Codable, identifiable, observable.","status":"open","priority":0,"issue_type":"feature","created_at":"2026-02-02T12:43:53.38051+01:00","created_by":"mayor","updated_at":"2026-02-02T12:43:53.38051+01:00","dependencies":[{"issue_id":"ch-tfk","depends_on_id":"ch-waq","type":"blocks","created_at":"2026-02-02T12:44:50.398553+01:00","created_by":"mayor"}]}
{"id":"ch-u9d","title":"[EPIC] InputForge: Interrogation Mode","description":"Chat-style UI for AI-driven clarifying questions. Triggered by global Ask Me Questions button or tapping uncertainty flags. Persona-aware domain questions. Multi-modal user replies (text, files, audio, clipboard). Running summary updates. Live clarity score. Done Refining button triggers re-analysis.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T12:44:11.08192+01:00","created_by":"mayor","updated_at":"2026-02-02T12:44:11.08192+01:00","dependencies":[{"issue_id":"ch-u9d","depends_on_id":"ch-t95","type":"blocks","created_at":"2026-02-02T12:44:51.278401+01:00","created_by":"mayor"}]}
{"id":"ch-w7i","title":"Implement Input Stage: drag-drop, clipboard, audio recording","description":"Implement the Input Stage UI — the main input collection view of InputForge.\n\n## Drop Zone\n- Full-area drag-and-drop target (NSItemProvider, UTType-based)\n- Accepted types: pdf, docx, txt, md, rtf, pages, images (png/jpg/heic/tiff), audio (m4a/mp3/wav/aac), video (mp4/mov/m4v), mindmap files (.mindnode, .mm, .opml)  \n- Clipboard paste: Cmd-V for images and text\n- Toast notification for unsupported file types\n\n## Audio Recording\n- Cmd-Shift-R starts/stops inline recording\n- AVFoundation-based recording to m4a\n- Recording indicator in UI\n- Recorded file becomes an InputItem\n\n## Input Card Grid\n- ScrollView with LazyVGrid layout\n- Each input as a card:\n  - Thumbnail (image preview, doc icon, audio waveform icon, video frame)\n  - Filename / source label\n  - Timestamp of import\n  - Type badge (using ForgeBadge component)\n- Drag to reorder inputs\n- Select input → shows detail panel / annotation area\n\n## File Processing\n- Copy imported files to document package assets/ directory\n- Update InputItem.dataRef with relative path\n- Generate thumbnails for images and video first frames\n- Text extraction for documents (basic: read text content)\n\n## Persona Selector\n- Visible persona indicator + dropdown to switch\n- Switching persona stored in document, does NOT trigger re-analysis yet (no analysis exists)\n\n## Verification\n- Drag files from Finder → cards appear\n- Paste image from clipboard → card appears  \n- Record audio → card appears with audio icon\n- Cards show correct thumbnails and metadata\n- Inputs persist across save/reopen\n- Multiple file types work simultaneously\n\nDepends on: data model (ch-0y4), design system (ch-bqq)","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T12:47:21.448793+01:00","created_by":"mayor","updated_at":"2026-02-02T12:47:21.448793+01:00","dependencies":[{"issue_id":"ch-w7i","depends_on_id":"ch-0y4","type":"blocks","created_at":"2026-02-02T12:47:36.018981+01:00","created_by":"mayor"},{"issue_id":"ch-w7i","depends_on_id":"ch-bqq","type":"blocks","created_at":"2026-02-02T12:47:36.092236+01:00","created_by":"mayor"}]}
{"id":"ch-waq","title":"[EPIC] InputForge: Project Scaffolding \u0026 NSDocument Architecture","description":"Create Xcode project, SwiftUI + AppKit NSDocument multi-document app shell, package bundle format (.inputforge), basic window management. Foundation for all other work.","status":"open","priority":0,"issue_type":"feature","created_at":"2026-02-02T12:43:51.055456+01:00","created_by":"mayor","updated_at":"2026-02-02T12:43:51.055456+01:00"}
{"id":"ch-x7h","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"open","priority":2,"issue_type":"molecule","created_at":"2026-02-02T12:41:15.785858+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:15.785858+01:00"}
{"id":"ch-xl3","title":"[EPIC] InputForge: Persona System","description":"Persona model (name + system prompt). Built-in personas: CPO, Engineer, Parent, Homeowner. Custom persona CRUD. Per-context default persona in Settings. Persona switching triggers re-processing. Persona affects output structure, tone, question style.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T12:43:59.838066+01:00","created_by":"mayor","updated_at":"2026-02-02T12:43:59.838066+01:00","dependencies":[{"issue_id":"ch-xl3","depends_on_id":"ch-tfk","type":"blocks","created_at":"2026-02-02T12:44:50.713118+01:00","created_by":"mayor"}]}
{"id":"ch-zvp","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"open","priority":2,"issue_type":"molecule","created_at":"2026-02-02T12:41:15.603107+01:00","created_by":"mandrigin","updated_at":"2026-02-02T12:41:15.603107+01:00"}
